---
comments: true
difficulty: ç®€å•
edit_url: https://github.com/doocs/leetcode/edit/main/solution/1400-1499/1421.NPV%20Queries/README.md
tags:
    - æ•°æ®åº“
---

# [1421. å‡€ç°å€¼æŸ¥è¯¢ ğŸ”’](https://leetcode.cn/problems/npv-queries)

[English Version](/solution/1400-1499/1421.NPV%20Queries/README_EN.md)

## é¢˜ç›®æè¿°

<!-- è¿™é‡Œå†™é¢˜ç›®æè¿° -->

<p>è¡¨: <code>NPV</code></p>

<pre>
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| year          | int     |
| npv           | int     |
+---------------+---------+
(id, year) æ˜¯è¯¥è¡¨ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ).
è¯¥è¡¨æœ‰æ¯ä¸€ç¬”å­˜è´§çš„å¹´ä»½, id å’Œå¯¹åº”å‡€ç°å€¼çš„ä¿¡æ¯.
</pre>

<p>&nbsp;</p>

<p>è¡¨: <code>Queries</code></p>

<pre>
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| id            | int     |
| year          | int     |
+---------------+---------+
(id, year) æ˜¯è¯¥è¡¨ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—çš„ç»„åˆ).
è¯¥è¡¨æœ‰æ¯ä¸€æ¬¡æŸ¥è¯¢æ‰€å¯¹åº”å­˜è´§çš„ id å’Œå¹´ä»½çš„ä¿¡æ¯.
</pre>

<p>&nbsp;</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼Œæ‰¾åˆ° Queries&nbsp;è¡¨ä¸­æ¯ä¸€æ¬¡æŸ¥è¯¢çš„å‡€ç°å€¼ã€‚</p>

<p>ç»“æœè¡¨ <strong>æ²¡æœ‰é¡ºåºè¦æ±‚ </strong>ã€‚</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤º:</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>
NPV è¡¨:
+------+--------+--------+
| id   | year   | npv    |
+------+--------+--------+
| 1    | 2018   | 100    |
| 7    | 2020   | 30     |
| 13   | 2019   | 40     |
| 1    | 2019   | 113    |
| 2    | 2008   | 121    |
| 3    | 2009   | 12     |
| 11   | 2020   | 99     |
| 7    | 2019   | 0      |
+------+--------+--------+

Queries è¡¨:
+------+--------+
| id   | year   |
+------+--------+
| 1    | 2019   |
| 2    | 2008   |
| 3    | 2009   |
| 7    | 2018   |
| 7    | 2019   |
| 7    | 2020   |
| 13   | 2019   |
+------+--------+
<strong>è¾“å‡ºï¼š</strong>
+------+--------+--------+
| id   | year   | npv    |
+------+--------+--------+
| 1    | 2019   | 113    |
| 2    | 2008   | 121    |
| 3    | 2009   | 12     |
| 7    | 2018   | 0      |
| 7    | 2019   | 0      |
| 7    | 2020   | 30     |
| 13   | 2019   | 40     |
+------+--------+--------+
<strong>è§£é‡Šï¼š</strong>
(7, 2018)çš„å‡€ç°å€¼ä¸åœ¨ NPV è¡¨ä¸­, æˆ‘ä»¬æŠŠå®ƒçœ‹ä½œæ˜¯ 0.
æ‰€æœ‰å…¶å®ƒæŸ¥è¯¢çš„å‡€ç°å€¼éƒ½èƒ½åœ¨ NPV è¡¨ä¸­æ‰¾åˆ°.
</pre>

## è§£æ³•

### æ–¹æ³•ä¸€

<!-- tabs:start -->

```sql
# Write your MySQL query statement below
SELECT q.*, IFNULL(npv, 0) AS npv
FROM
    Queries AS q
    LEFT JOIN NPV AS n USING (id, year);
```

<!-- tabs:end -->

<!-- end -->
