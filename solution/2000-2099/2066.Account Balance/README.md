---
comments: true
difficulty: ä¸­ç­‰
edit_url: https://github.com/doocs/leetcode/edit/main/solution/2000-2099/2066.Account%20Balance/README.md
tags:
    - æ•°æ®åº“
---

# [2066. è´¦æˆ·ä½™é¢ ğŸ”’](https://leetcode.cn/problems/account-balance)

[English Version](/solution/2000-2099/2066.Account%20Balance/README_EN.md)

## é¢˜ç›®æè¿°

<!-- è¿™é‡Œå†™é¢˜ç›®æè¿° -->

<p>è¡¨å: <code>Transactions</code></p>

<pre>
+-------------+------+
| Column Name | Type |
+-------------+------+
| account_id  | int  |
| day         | date |
| type        | ENUM |
| amount      | int  |
+-------------+------+
(account_id, day) æ˜¯è¯¥Transactionsè¡¨çš„ä¸»é”®.
è¡¨ä¸­çš„æ¯è¡Œæ•°æ®è¡¨ç¤ºä¸€æ¬¡äº¤æ˜“çš„ä¿¡æ¯, åŒ…æ‹¬æ­¤æ¬¡äº¤æ˜“çš„è´¦å·(account_id), äº¤æ˜“ç±»å‹(type), äº¤æ˜“å‘ç”Ÿæ—¶é—´(day), äº¤æ˜“å‘ç”Ÿé‡‘é¢(amount).
å…¶ä¸­äº¤æ˜“ç±»å‹(type)å­—æ®µåŒ…æ‹¬äº†ä¸¤ç§è¡Œä¸ºï¼šå­˜å…¥ ('Deposit'), å–å‡º('Withdraw').
</pre>

<p>&nbsp;</p>

<p>è¯·å†™å‡ºèƒ½å¤Ÿè¿”å›ç”¨æˆ·æ¯æ¬¡äº¤æ˜“å®Œæˆåçš„è´¦æˆ·ä½™é¢. æˆ‘ä»¬çº¦å®šæ‰€æœ‰ç”¨æˆ·åœ¨è¿›è¡Œäº¤æ˜“å‰çš„è´¦æˆ·ä½™é¢éƒ½ä¸º0ï¼Œ&nbsp;å¹¶ä¸”ä¿è¯æ‰€æœ‰äº¤æ˜“è¡Œä¸ºåçš„ä½™é¢ä¸ä¸ºè´Ÿæ•°ã€‚</p>

<p>è¿”å›çš„ç»“æœè¯·ä¾æ¬¡æŒ‰ç…§ è´¦æˆ·ï¼ˆ<code>account_id</code>),&nbsp;æ—¥æœŸ(&nbsp;<code>day</code>&nbsp;) è¿›è¡Œ<strong>å‡åºæ’åº</strong>&nbsp;.</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼è¯·å‚ç…§ä»¥ä¸‹æµ‹è¯•æ ·ä¾‹.</p>

<p>&nbsp;</p>

<p><strong>æµ‹è¯•æ ·ä¾‹1:</strong></p>

<pre>
<strong>è¾“å…¥:</strong> 
Transactions è¡¨:
+------------+------------+----------+--------+
| account_id | day        | type     | amount |
+------------+------------+----------+--------+
| 1          | 2021-11-07 | Deposit  | 2000   |
| 1          | 2021-11-09 | Withdraw | 1000   |
| 1          | 2021-11-11 | Deposit  | 3000   |
| 2          | 2021-12-07 | Deposit  | 7000   |
| 2          | 2021-12-12 | Withdraw | 7000   |
+------------+------------+----------+--------+
<strong>è¾“å‡º:</strong> 
+------------+------------+---------+
| account_id | day        | balance |
+------------+------------+---------+
| 1          | 2021-11-07 | 2000    |
| 1          | 2021-11-09 | 1000    |
| 1          | 2021-11-11 | 4000    |
| 2          | 2021-12-07 | 7000    |
| 2          | 2021-12-12 | 0       |
+------------+------------+---------+

<strong>è§£é‡Š:</strong> 
è´¦æˆ·1:
- åˆå§‹é‡‘é¢ä¸º 0.
- 2021-11-07 --&gt; å­˜å…¥2000. ä½™é¢å˜ä¸º 0 + 2000 = 2000.
- 2021-11-09 --&gt; å–å‡º1000. ä½™é¢å˜ä¸º 2000 - 1000 = 1000.
- 2021-11-11 --&gt; å­˜å…¥3000. ä½™é¢å˜ä¸º 1000 + 3000 = 4000.
è´¦æˆ·2:
- åˆå§‹é‡‘é¢ä¸º 0.
- 2021-12-07 --&gt; å­˜å…¥7000. ä½™é¢å˜ä¸º 0 + 7000 = 7000.
- 2021-12-12 --&gt; å–å‡º 7000. ä½™é¢å˜ä¸º 7000 - 7000 = 0.
</pre>

## è§£æ³•

### æ–¹æ³•ä¸€

<!-- tabs:start -->

```sql
# Write your MySQL query statement below
SELECT
    account_id,
    day,
    SUM(IF(type = 'Deposit', amount, -amount)) OVER (
        PARTITION BY account_id
        ORDER BY day
    ) AS balance
FROM Transactions
ORDER BY 1, 2;
```

<!-- tabs:end -->

<!-- end -->
