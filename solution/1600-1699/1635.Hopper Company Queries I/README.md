---
comments: true
difficulty: å›°éš¾
edit_url: https://github.com/doocs/leetcode/edit/main/solution/1600-1699/1635.Hopper%20Company%20Queries%20I/README.md
tags:
    - æ•°æ®åº“
---

# [1635. Hopper å…¬å¸æŸ¥è¯¢ I ğŸ”’](https://leetcode.cn/problems/hopper-company-queries-i)

[English Version](/solution/1600-1699/1635.Hopper%20Company%20Queries%20I/README_EN.md)

## é¢˜ç›®æè¿°

<!-- è¿™é‡Œå†™é¢˜ç›®æè¿° -->

<p>è¡¨: <code>Drivers</code></p>

<pre>
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| driver_id   | int     |
| join_date   | date    |
+-------------+---------+
driver_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«é©¾é©¶å‘˜çš„IDä»¥åŠä»–ä»¬åŠ å…¥Hopperå…¬å¸çš„æ—¥æœŸã€‚
</pre>

<p>&nbsp;</p>

<p>è¡¨: <code>Rides</code></p>

<pre>
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| ride_id      | int     |
| user_id      | int     |
| requested_at | date    |
+--------------+---------+
ride_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œå‡åŒ…å«è¡Œç¨‹ID(ride_id)ï¼Œç”¨æˆ·ID(user_id)ä»¥åŠè¯¥è¡Œç¨‹çš„æ—¥æœŸ(requested_at)ã€‚
è¯¥è¡¨ä¸­å¯èƒ½æœ‰ä¸€äº›ä¸è¢«æ¥å—çš„ä¹˜è½¦è¯·æ±‚ã€‚
</pre>

<p>&nbsp;</p>

<p>è¡¨: <code>AcceptedRides</code></p>

<pre>
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| ride_id       | int     |
| driver_id     | int     |
| ride_distance | int     |
| ride_duration | int     |
+---------------+---------+
ride_id æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡Œéƒ½åŒ…å«å·²æ¥å—çš„è¡Œç¨‹ä¿¡æ¯ã€‚
è¡¨ä¸­çš„è¡Œç¨‹ä¿¡æ¯éƒ½åœ¨â€œ<code>Rides</code>â€è¡¨ä¸­å­˜åœ¨ã€‚
</pre>

<p>&nbsp;</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆä»¥æŠ¥å‘Š <strong>2020</strong> å¹´æ¯ä¸ªæœˆçš„ä»¥ä¸‹ç»Ÿè®¡ä¿¡æ¯ï¼š</p>

<ul>
	<li>æˆªè‡³æŸæœˆåº•ï¼Œå½“å‰åœ¨Hopperå…¬å¸å·¥ä½œçš„é©¾é©¶å‘˜æ•°é‡ï¼ˆ<code>active_drivers</code>ï¼‰ã€‚</li>
	<li>è¯¥æœˆæ¥å—çš„ä¹˜è½¦æ¬¡æ•°ï¼ˆ<code>accepted_rides</code>ï¼‰ã€‚</li>
</ul>

<p>è¿”å›æŒ‰<code>month</code> å‡åºæ’åˆ—çš„ç»“æœè¡¨ï¼Œå…¶ä¸­<code>month</code> æ˜¯æœˆä»½çš„æ•°å­—ï¼ˆä¸€æœˆæ˜¯<code>1</code>ï¼ŒäºŒæœˆæ˜¯<code>2</code>ï¼Œä¾æ­¤ç±»æ¨ï¼‰ã€‚</p>

<p>è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<strong>è¾“å…¥ï¼š</strong>
è¡¨ Drivers:
+-----------+------------+
| driver_id | join_date  |
+-----------+------------+
| 10        | 2019-12-10 |
| 8         | 2020-1-13  |
| 5         | 2020-2-16  |
| 7         | 2020-3-8   |
| 4         | 2020-5-17  |
| 1         | 2020-10-24 |
| 6         | 2021-1-5   |
+-----------+------------+
è¡¨ Rides:
+---------+---------+--------------+
| ride_id | user_id | requested_at |
+---------+---------+--------------+
| 6       | 75      | 2019-12-9    |
| 1       | 54      | 2020-2-9     |
| 10      | 63      | 2020-3-4     |
| 19      | 39      | 2020-4-6     |
| 3       | 41      | 2020-6-3     |
| 13      | 52      | 2020-6-22    |
| 7       | 69      | 2020-7-16    |
| 17      | 70      | 2020-8-25    |
| 20      | 81      | 2020-11-2    |
| 5       | 57      | 2020-11-9    |
| 2       | 42      | 2020-12-9    |
| 11      | 68      | 2021-1-11    |
| 15      | 32      | 2021-1-17    |
| 12      | 11      | 2021-1-19    |
| 14      | 18      | 2021-1-27    |
+---------+---------+--------------+
è¡¨ AcceptedRides:
+---------+-----------+---------------+---------------+
| ride_id | driver_id | ride_distance | ride_duration |
+---------+-----------+---------------+---------------+
| 10      | 10        | 63            | 38            |
| 13      | 10        | 73            | 96            |
| 7       | 8         | 100           | 28            |
| 17      | 7         | 119           | 68            |
| 20      | 1         | 121           | 92            |
| 5       | 7         | 42            | 101           |
| 2       | 4         | 6             | 38            |
| 11      | 8         | 37            | 43            |
| 15      | 8         | 108           | 82            |
| 12      | 8         | 38            | 34            |
| 14      | 1         | 90            | 74            |
+---------+-----------+---------------+---------------+
<strong>è¾“å‡ºï¼š</strong>
+-------+----------------+----------------+
| month | active_drivers | accepted_rides |
+-------+----------------+----------------+
| 1     | 2              | 0              |
| 2     | 3              | 0              |
| 3     | 4              | 1              |
| 4     | 4              | 0              |
| 5     | 5              | 0              |
| 6     | 5              | 1              |
| 7     | 5              | 1              |
| 8     | 5              | 1              |
| 9     | 5              | 0              |
| 10    | 6              | 0              |
| 11    | 6              | 2              |
| 12    | 6              | 1              |
+-------+----------------+----------------+
<strong>è§£é‡Šï¼š</strong>
æˆªè‡³1æœˆåº•-&gt;ä¸¤ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³2æœˆåº•-&gt;ä¸‰ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³3æœˆåº•-&gt;å››ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ10ï¼‰ã€‚
æˆªè‡³4æœˆåº•-&gt;å››ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³5æœˆåº•-&gt;äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³6æœˆåº•-&gt;äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ13ï¼‰ã€‚
æˆªè‡³7æœˆåº•-&gt;äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ7ï¼‰ã€‚
æˆªè‡³8æœˆåº•-&gt;äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œä¸€ä½æ¥å—çš„è¡Œç¨‹ï¼ˆ17ï¼‰ã€‚
æˆªè‡³9æœˆåº•-&gt;äº”ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³10æœˆåº•-&gt;å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œæ²¡æœ‰è¢«æ¥å—çš„è¡Œç¨‹ã€‚
æˆªè‡³11æœˆåº•-&gt;å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œä¸¤ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ20,5ï¼‰ã€‚
æˆªè‡³12æœˆåº•-&gt;å…­ä¸ªæ´»è·ƒçš„é©¾é©¶å‘˜ï¼ˆ10,8,5,7,4,1ï¼‰ï¼Œä¸€ä¸ªè¢«æ¥å—çš„è¡Œç¨‹ï¼ˆ2ï¼‰ã€‚</pre>

## è§£æ³•

### æ–¹æ³•ä¸€

<!-- tabs:start -->

```sql
# Write your MySQL query statement below
WITH
    recursive Months AS (
        SELECT
            1 AS month
        UNION ALL
        SELECT
            month + 1
        FROM Months
        WHERE month < 12
    ),
    Ride AS (
        SELECT MONTH(requested_at) AS month, COUNT(1) AS cnt
        FROM
            Rides AS r
            JOIN AcceptedRides AS a
                ON r.ride_id = a.ride_id AND YEAR(requested_at) = 2020
        GROUP BY month
    )
SELECT
    m.month,
    COUNT(driver_id) AS active_drivers,
    IFNULL(r.cnt, 0) AS accepted_rides
FROM
    Months AS m
    LEFT JOIN Drivers AS d
        ON (m.month >= MONTH(d.join_date) AND YEAR(d.join_date) = 2020)
        OR YEAR(d.join_date) < 2020
    LEFT JOIN Ride AS r ON m.month = r.month
GROUP BY month;
```

<!-- tabs:end -->

<!-- end -->
