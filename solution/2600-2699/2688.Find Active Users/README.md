# [2688. æŸ¥æ‰¾æ´»è·ƒç”¨æˆ· ğŸ”’](https://leetcode.cn/problems/find-active-users)

[English Version](/solution/2600-2699/2688.Find%20Active%20Users/README_EN.md)

<!-- tags:æ•°æ®åº“ -->

<!-- difficulty:ä¸­ç­‰ -->

## é¢˜ç›®æè¿°

<!-- è¿™é‡Œå†™é¢˜ç›®æè¿° -->

<p><font face="monospace"><code>Users</code> è¡¨ï¼š</font></p>

<pre>
+-------------+----------+ 
| å­—æ®µå       | ç±»å‹      | 
+-------------+----------+ 
| user_id     | int      | 
| item        | varchar  |
| created_at  | datetime |
| amount      | int      |
+-------------+----------+
åœ¨è¿™ä¸ªè¡¨å¯èƒ½åŒ…å«é‡å¤çš„è®°å½•ã€‚
æ¯ä¸€è¡ŒåŒ…æ‹¬ user_idã€è´­ä¹°çš„å•†å“ã€è´­ä¹°æ—¥æœŸå’Œè´­ä¹°é‡‘é¢ã€‚</pre>

<p>ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ´»è·ƒç”¨æˆ·ã€‚æ´»è·ƒç”¨æˆ·æ˜¯æŒ‡åœ¨å…¶ä»»ä½•ä¸€æ¬¡è´­ä¹°ä¹‹åçš„ <strong>ä¸ƒå¤©å†…</strong>&nbsp;è¿›è¡Œäº†ç¬¬äºŒæ¬¡è´­ä¹°çš„ç”¨æˆ·ã€‚</p>

<p>ä¾‹å¦‚ï¼Œå¦‚æœç»“æŸæ—¥æœŸæ˜¯ 2023å¹´5æœˆ31æ—¥ï¼Œé‚£ä¹ˆåœ¨ 2023å¹´5æœˆ31æ—¥ å’Œ 2023å¹´6æœˆ7æ—¥ä¹‹é—´ï¼ˆåŒ…æ‹¬è¿™ä¸¤å¤©ï¼‰çš„ä»»ä½•æ—¥æœŸéƒ½è¢«è§†ä¸º"åœ¨7å¤©å†…"ã€‚</p>

<p>è¿”å› <strong>ä»»æ„é¡ºåº</strong> çš„ <code>user_id</code> åˆ—è¡¨ï¼Œè¡¨ç¤ºæ´»è·ƒç”¨æˆ·åˆ—è¡¨ã€‚</p>

<p>ç»“æœçš„æ ¼å¼å¦‚ä¸‹ç¤ºä¾‹ï¼š</p>

<p>&nbsp;</p>

<p><b>ç¤ºä¾‹ 1ï¼š</b></p>

<pre>
<strong>è¾“å…¥ï¼š
</strong>Users è¡¨:
+---------+-------------------+------------+--------+ 
| user_id | item              | created_at | amount |  
+---------+-------------------+------------+--------+
| 5       | Smart Crock Pot   | 2021-09-18 | 698882 |
| 6       | Smart Lock        | 2021-09-14 | 11487  |
| 6       | Smart Thermostat  | 2021-09-10 | 674762 |
| 8       | Smart Light Strip | 2021-09-29 | 630773 |
| 4       | Smart Cat Feeder  | 2021-09-02 | 693545 |
| 4       | Smart Bed         | 2021-09-13 | 170249 |
+---------+-------------------+------------+--------+ 
<b>è¾“å‡ºï¼š</b>
+---------+
| user_id | 
+---------+
| 6       | 
+---------+
<b>è§£é‡Šï¼š</b>
â€“ user_id ä¸º 5 çš„ç”¨æˆ·åªæœ‰ä¸€ç¬”äº¤æ˜“ï¼Œå› æ­¤ä»–ä¸æ˜¯æ´»è·ƒç”¨æˆ·ã€‚
â€“ user_id ä¸º 6 çš„ç”¨æˆ·æœ‰ä¸¤ç¬”äº¤æ˜“ï¼Œç¬¬ä¸€ç¬”äº¤æ˜“æ˜¯åœ¨2021å¹´9æœˆ10æ—¥ï¼Œç¬¬äºŒç¬”äº¤æ˜“æ˜¯åœ¨2021å¹´9æœˆ14æ—¥ã€‚ç¬¬ä¸€ç¬”å’Œç¬¬äºŒç¬”äº¤æ˜“ä¹‹é—´çš„æ—¶é—´é—´éš”å°äºç­‰äº7å¤©ã€‚å› æ­¤ï¼Œä»–æ˜¯ä¸€ä¸ªæ´»è·ƒç”¨æˆ·ã€‚
â€“ user_id ä¸º 8 çš„ç”¨æˆ·åªæœ‰ä¸€ç¬”äº¤æ˜“ï¼Œå› æ­¤ä»–ä¸æ˜¯æ´»è·ƒç”¨æˆ·ã€‚
â€“ user_id ä¸º 4 çš„ç”¨æˆ·æœ‰ä¸¤ç¬”äº¤æ˜“ï¼Œç¬¬ä¸€ç¬”äº¤æ˜“æ˜¯åœ¨2021å¹´9æœˆ2æ—¥ï¼Œç¬¬äºŒç¬”äº¤æ˜“æ˜¯åœ¨2021å¹´9æœˆ13æ—¥ã€‚ç¬¬ä¸€ç¬”å’Œç¬¬äºŒç¬”äº¤æ˜“ä¹‹é—´çš„æ—¶é—´é—´éš”å¤§äº7å¤©ã€‚å› æ­¤ï¼Œä»–ä¸æ˜¯æ´»è·ƒç”¨æˆ·ã€‚</pre>

## è§£æ³•

### æ–¹æ³•ä¸€

<!-- tabs:start -->

```sql
# Write your MySQL query statement
SELECT DISTINCT
    user_id
FROM Users
WHERE
    user_id IN (
        SELECT
            user_id
        FROM
            (
                SELECT
                    user_id,
                    created_at,
                    LAG(created_at, 1) OVER (
                        PARTITION BY user_id
                        ORDER BY created_at
                    ) AS prev_created_at
                FROM Users
            ) AS t
        WHERE DATEDIFF(created_at, prev_created_at) <= 7
    );
```

<!-- tabs:end -->

<!-- end -->
