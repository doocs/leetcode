---
comments: true
difficulty: ä¸­ç­‰
edit_url: https://github.com/doocs/leetcode/edit/main/solution/2900-2999/2993.Friday%20Purchases%20I/README.md
tags:
    - æ•°æ®åº“
---

<!-- problem:start -->

# [2993. å‘ç”Ÿåœ¨å‘¨äº”çš„äº¤æ˜“ I ğŸ”’](https://leetcode.cn/problems/friday-purchases-i)

[English Version](/solution/2900-2999/2993.Friday%20Purchases%20I/README_EN.md)

## é¢˜ç›®æè¿°

<!-- description:start -->

<p>è¡¨ï¼š&nbsp;<code>Purchases</code></p>

<pre>
+---------------+------+
| Column Name   | Type |
+---------------+------+
| user_id       | int  |
| purchase_date | date |
| amount_spend  | int  |
+---------------+------+
(user_id, purchase_date, amount_spend) æ˜¯è¯¥è¡¨çš„ä¸»é”®(å…·æœ‰å”¯ä¸€å€¼çš„åˆ—)ã€‚
purchase_date çš„èŒƒå›´ä» 2023 å¹´ 11 æœˆ 1 æ—¥åˆ° 2023 å¹´ 11 æœˆ 30 æ—¥ï¼Œå¹¶åŒ…æ‹¬è¿™ä¸¤ä¸ªæ—¥æœŸã€‚
æ¯ä¸€è¡ŒåŒ…å« user id, purchase dateï¼Œå’Œ amount spendã€‚
</pre>

<p>ç¼–å†™ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œè®¡ç®—ç”¨æˆ·åœ¨ <strong>2023 å¹´ 11 æœˆ&nbsp;</strong>çš„ <strong>æ¯ä¸ªæ˜ŸæœŸäº”</strong> çš„ <strong>æ€»èŠ±è´¹</strong>ã€‚è¾“å‡ºæ‰€æœ‰åœ¨&nbsp;<strong>å‘¨äº”&nbsp;</strong>æœ‰è´­ä¹°è®°å½•çš„å‘¨ã€‚</p>

<p>æŒ‰ç…§æ¯æœˆçš„å‘¨æ¬¡åº <strong>å‡åº</strong> æ’åˆ—ç»“æœè¡¨ã€‚</p>

<p>ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><b>ç¤ºä¾‹ 1ï¼š</b></p>

<pre>
<b>è¾“å…¥ï¼š</b>
Purchases table:
+---------+---------------+--------------+
| user_id | purchase_date | amount_spend |
+---------+---------------+--------------+
| 11      | 2023-11-07    | 1126         |
| 15      | 2023-11-30    | 7473         |
| 17      | 2023-11-14    | 2414         |
| 12      | 2023-11-24    | 9692         |
| 8       | 2023-11-03    | 5117         |
| 1       | 2023-11-16    | 5241         |
| 10      | 2023-11-12    | 8266         |
| 13      | 2023-11-24    | 12000        |
+---------+---------------+--------------+
<b>è¾“å‡ºï¼š</b>
+---------------+---------------+--------------+
| week_of_month | purchase_date | total_amount |
+---------------+---------------+--------------+
| 1             | 2023-11-03    | 5117         |
| 4             | 2023-11-24    | 21692        |
+---------------+---------------+--------------+ 
<b>è§£é‡Šï¼š</b>
- åœ¨ 2023 å¹´ 11 æœˆçš„ç¬¬ä¸€å‘¨ï¼Œäº 2023-11-03 æ˜ŸæœŸäº”å‘ç”Ÿäº†æ€»é¢ä¸º $5,117 çš„äº¤æ˜“ã€‚
- å¯¹äº 2023 å¹´ 11 æœˆçš„ç¬¬äºŒå‘¨ï¼Œäº 2023-11-10 æ˜ŸæœŸäº”æ²¡æœ‰äº¤æ˜“ã€‚
- åŒæ ·ï¼Œåœ¨ 2023 å¹´ 11 æœˆçš„ç¬¬ä¸‰å‘¨ï¼Œäº 2023-11-17 æ˜ŸæœŸäº”æ²¡æœ‰äº¤æ˜“ã€‚
- åœ¨ 2023 å¹´ 11 æœˆçš„ç¬¬å››å‘¨ï¼Œäº 2023-11-24 æ˜ŸæœŸäº”å‘ç”Ÿäº†ä¸¤ç¬”äº¤æ˜“ï¼Œåˆ†åˆ«ä¸º $12,000 å’Œ $9,692ï¼Œæ€»è®¡ä¸º $21,692ã€‚
è¾“å‡ºè¡¨æŒ‰ç…§ week_of_month å‡åºæ’åˆ—ã€‚</pre>

<!-- description:end -->

## è§£æ³•

<!-- solution:start -->

### æ–¹æ³•ä¸€ï¼šæ—¥æœŸå‡½æ•°

æˆ‘ä»¬ç”¨åˆ°çš„æ—¥æœŸå‡½æ•°æœ‰ï¼š

-   `DATE_FORMAT(date, format)`ï¼šå°†æ—¥æœŸæ ¼å¼åŒ–ä¸ºå­—ç¬¦ä¸²
-   `DAYOFWEEK(date)`ï¼šè¿”å›æ—¥æœŸå¯¹åº”çš„æ˜ŸæœŸå‡ ï¼Œ1 ä»£è¡¨æ˜ŸæœŸæ—¥ï¼Œ2 ä»£è¡¨æ˜ŸæœŸä¸€ï¼Œä»¥æ­¤ç±»æ¨
-   `DAYOFMONTH(date)`ï¼šè¿”å›æ—¥æœŸå¯¹åº”çš„æœˆä»½ä¸­çš„ç¬¬å‡ å¤©

æˆ‘ä»¬å…ˆç”¨ `DATE_FORMAT` å‡½æ•°å°†æ—¥æœŸæ ¼å¼åŒ–ä¸º `YYYYMM` çš„å½¢å¼ï¼Œç„¶åç­›é€‰å‡º 2023 å¹´ 11 æœˆä¸”æ˜¯æ˜ŸæœŸäº”çš„è®°å½•ï¼Œç„¶åå°†è®°å½•æŒ‰ç…§ `purchase_date` åˆ†ç»„ï¼Œè®¡ç®—å‡ºæ¯ä¸ªæ˜ŸæœŸäº”çš„æ€»æ¶ˆè´¹é‡‘é¢ã€‚

<!-- tabs:start -->

#### MySQL

```sql
# Write your MySQL query statement below
SELECT
    CEIL(DAYOFMONTH(purchase_date) / 7) AS week_of_month,
    purchase_date,
    SUM(amount_spend) AS total_amount
FROM Purchases
WHERE DATE_FORMAT(purchase_date, '%Y%m') = '202311' AND DAYOFWEEK(purchase_date) = 6
GROUP BY 2
ORDER BY 1;
```

<!-- tabs:end -->

<!-- solution:end -->

<!-- problem:end -->
