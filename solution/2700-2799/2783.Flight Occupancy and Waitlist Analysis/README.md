---
comments: true
difficulty: ä¸­ç­‰
edit_url: https://github.com/doocs/leetcode/edit/main/solution/2700-2799/2783.Flight%20Occupancy%20and%20Waitlist%20Analysis/README.md
tags:
    - æ•°æ®åº“
---

<!-- problem:start -->

# [2783. èˆªç­å…¥åº§ç‡å’Œç­‰å¾…åå•åˆ†æ ğŸ”’](https://leetcode.cn/problems/flight-occupancy-and-waitlist-analysis)

[English Version](/solution/2700-2799/2783.Flight%20Occupancy%20and%20Waitlist%20Analysis/README_EN.md)

## é¢˜ç›®æè¿°

<!-- description:start -->

<p><code><font face="monospace">Flights</font></code>è¡¨</p>

<pre>
+-------------+------+
| åˆ—å         | ç±»å‹ |
+-------------+------+
| flight_id   | int  |
| capacity    | int  |
+-------------+------+
flight_id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚ 
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«èˆªç­IDå’Œå®ƒçš„åº§ä½å®¹é‡ã€‚
</pre>

<p><code>Passengers</code>è¡¨</p>

<pre>
+--------------+------+
| Column Name  | Type |
+--------------+------+
| passenger_id | int  |
| flight_id    | int  |
+--------------+------+
passenger_id æ˜¯è¯¥è¡¨ä¸­å…·æœ‰å”¯ä¸€å€¼çš„åˆ—ã€‚
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¹˜å®¢IDå’Œèˆªç­IDã€‚
</pre>

<p>ä¹˜å®¢æå‰é¢„è®¢èˆªç­æœºç¥¨ã€‚å¦‚æœä¹˜å®¢é¢„è®¢äº†æŸä¸ªèˆªç­çš„æœºç¥¨ï¼Œå¹¶ä¸”è¯¥èˆªç­è¿˜æœ‰ç©ºåº§ä½ï¼Œä¹˜å®¢çš„æœºç¥¨å°†ä¼šå¾—åˆ° <strong>ç¡®è®¤</strong> ã€‚ç„¶è€Œï¼Œå¦‚æœèˆªç­å·²ç»æ»¡å‘˜ï¼Œä¹˜å®¢å°†ä¼šè¿›å…¥ <strong>ç­‰å¾…åå•</strong> ã€‚</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆï¼ŒæŠ¥å‘Šæ¯ä¸ªèˆªç­å·²æˆåŠŸé¢„è®¢ï¼ˆè·å¾—åº§ä½ï¼‰çš„ä¹˜å®¢æ•°ä»¥åŠå¤„äºç­‰å¾…åå•ä¸Šçš„ä¹˜å®¢æ•°ã€‚</p>

<p>æŒ‰ç…§ <code>flight_id</code> <strong>å‡åºæ’åº&nbsp;</strong>è¿”å›ç»“æœè¡¨ã€‚</p>

<p>ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><strong class="example">ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>
Flights table:
+-----------+----------+
| flight_id | capacity |
+-----------+----------+
| 1         | 2        |
| 2         | 2        |
| 3         | 1        |
+-----------+----------+
Passengers table:
+--------------+-----------+
| passenger_id | flight_id |
+--------------+-----------+
| 101          | 1         |
| 102          | 1         |
| 103          | 1         |
| 104          | 2         |
| 105          | 2         |
| 106          | 3         |
| 107          | 3         |
+--------------+-----------+
<b>è¾“å‡ºï¼š</b>
+-----------+------------+--------------+
| flight_id | booked_cnt | waitlist_cnt |
+-----------+------------+--------------+
| 1         | 2          | 1            |
| 2         | 2          | 0            |
| 3         | 1          | 1            |
+-----------+------------+--------------+
<b>è§£é‡Šï¼š</b>
- èˆªç­ 1 çš„åº§ä½å®¹é‡ä¸º 2ã€‚ç”±äºæœ‰ 3 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œåªæœ‰ 2 åä¹˜å®¢å¯ä»¥è·å¾—åº§ä½ã€‚å› æ­¤ï¼Œæœ‰ 2 åä¹˜å®¢æˆåŠŸé¢„è®¢ï¼Œå¹¶ä¸”æœ‰ 1 åä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚
- èˆªç­ 2 çš„åº§ä½å®¹é‡ä¸º 2ã€‚ç”±äºæœ‰ 2 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥è·å¾—åº§ä½ã€‚ç»“æœæ˜¯ï¼Œæœ‰ 2 åä¹˜å®¢æˆåŠŸé¢„è®¢äº†åº§ä½ï¼Œä¸”æ²¡æœ‰ä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚
- èˆªç­ 3 çš„åº§ä½å®¹é‡ä¸º 1ã€‚ç”±äºæœ‰ 2 åä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œåªæœ‰ 1 åä¹˜å®¢å¯ä»¥è·å¾—åº§ä½ã€‚å› æ­¤ï¼Œæœ‰ 1 åä¹˜å®¢æˆåŠŸé¢„è®¢ï¼Œå¹¶ä¸”æœ‰ 1 åä¹˜å®¢åœ¨ç­‰å¾…åå•ä¸Šã€‚</pre>

<!-- description:end -->

## è§£æ³•

<!-- solution:start -->

### æ–¹æ³•ä¸€ï¼šå·¦è¿æ¥ + åˆ†ç»„

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·¦è¿æ¥å°† `Flights` å’Œ `Passengers` è¡¨è¿æ¥èµ·æ¥ï¼Œç„¶åæŒ‰ç…§ `flight_id` åˆ†ç»„ï¼Œç»Ÿè®¡æ¯ä¸ªèˆªç­çš„ä¹˜å®¢æ•°é‡ã€‚

å¯¹äºæ¯ä¸ªèˆªç­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `count(passenger_id)` ç»Ÿè®¡ä¹˜å®¢æ•°é‡ï¼Œå– `capacity` å’Œ `count(passenger_id)` çš„æœ€å°å€¼ä½œä¸ºå·²é¢„è®¢çš„ä¹˜å®¢æ•°é‡ï¼Œå– `count(passenger_id) - capacity` å’Œ $0$ çš„æœ€å¤§å€¼ä½œä¸ºç­‰å¾…åå•ä¸Šçš„ä¹˜å®¢æ•°é‡ã€‚

<!-- tabs:start -->

#### MySQL

```sql
# Write your MySQL query statement below
SELECT
    flight_id,
    LEAST(COUNT(passenger_id), capacity) AS booked_cnt,
    GREATEST(COUNT(passenger_id) - capacity, 0) AS waitlist_cnt
FROM
    Flights
    LEFT JOIN Passengers USING (flight_id)
GROUP BY 1
ORDER BY 1;
```

<!-- tabs:end -->

<!-- solution:end -->

<!-- problem:end -->
