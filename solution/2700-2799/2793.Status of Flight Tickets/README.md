---
comments: true
difficulty: å›°éš¾
edit_url: https://github.com/doocs/leetcode/edit/main/solution/2700-2799/2793.Status%20of%20Flight%20Tickets/README.md
---

<!-- problem:start -->

# [2793. èˆªç­æœºç¥¨çŠ¶æ€ ğŸ”’](https://leetcode.cn/problems/status-of-flight-tickets)

[English Version](/solution/2700-2799/2793.Status%20of%20Flight%20Tickets/README_EN.md)

## é¢˜ç›®æè¿°

<!-- description:start -->

<p>è¡¨ï¼š&nbsp;<code><font face="monospace">Flights</font></code></p>

<pre>
+-------------+------+
| åˆ—å        | ç±»å‹ |
+-------------+------+
| flight_id   | int  |
| capacity    | int  |
+-------------+------+
flight_id åˆ—åŒ…å«ä¸åŒçš„å€¼ã€‚
æ¯è¡ŒåŒ…å«èˆªç­ id å’Œåº§ä½å®¹é‡ã€‚
</pre>

<p>è¡¨ï¼š<code>Passengers</code></p>

<pre>
+--------------+----------+
| åˆ—å         | ç±»å‹ |
+--------------+----------+
| passenger_id | int      |
| flight_id    | int      |
| booking_time | datetime |
+--------------+----------+
passenger_id åŒ…å«ä¸åŒçš„å€¼ã€‚
booking_time åŒ…å«ä¸åŒçš„å€¼ã€‚
æ¯è¡ŒåŒ…å«ä¹˜å®¢ idã€é¢„è®¢æ—¶é—´å’Œæ‰€é¢„è®¢çš„èˆªç­ idã€‚
</pre>

<p>ä¹˜å®¢æå‰é¢„è®¢èˆªç­æœºç¥¨ã€‚å¦‚æœä¹˜å®¢é¢„è®¢äº†ä¸€å¼ èˆªç­æœºç¥¨ï¼Œå¹¶ä¸”èˆªç­ä¸Šè¿˜æœ‰ç©ºåº§ä½ï¼Œåˆ™ä¹˜å®¢çš„æœºç¥¨å°† <strong>å¾—åˆ°ç¡®è®¤</strong> ã€‚ç„¶è€Œï¼Œå¦‚æœèˆªç­å·²ç»æ»¡å‘˜ï¼Œä¹˜å®¢å°†è¢«åˆ—å…¥ <strong>ç­‰å€™åå•</strong> ã€‚</p>

<p>ç¼–å†™è§£å†³æ–¹æ¡ˆæ¥ç¡®å®šæ¯ä¸ªä¹˜å®¢èˆªç­æœºç¥¨çš„å½“å‰çŠ¶æ€ã€‚</p>

<p>æŒ‰ <code>passenger_id</code> <strong>å‡åºæ’åº&nbsp;</strong>è¿”å›ç»“æœè¡¨ã€‚</p>

<p>æŸ¥è¯¢ç»“æœçš„æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºã€‚</p>

<p>&nbsp;</p>

<p><strong class="example">ç¤ºä¾‹ 1ï¼š</strong></p>

<pre>
<b>è¾“å…¥ï¼š</b>
Flights è¡¨:
+-----------+----------+
| flight_id | capacity |
+-----------+----------+
| 1         | 2        |
| 2         | 2        |
| 3         | 1        |
+-----------+----------+
Passengers è¡¨:
+--------------+-----------+---------------------+
| passenger_id | flight_id | booking_time        |
+--------------+-----------+---------------------+
| 101          | 1         | 2023-07-10 16:30:00 |
| 102          | 1         | 2023-07-10 17:45:00 |
| 103          | 1         | 2023-07-10 12:00:00 |
| 104          | 2         | 2023-07-05 13:23:00 |
| 105          | 2         | 2023-07-05 09:00:00 |
| 106          | 3         | 2023-07-08 11:10:00 |
| 107          | 3         | 2023-07-08 09:10:00 |
+--------------+-----------+---------------------+
<b>è¾“å‡ºï¼š</b>
+--------------+-----------+
| passenger_id | Status    |
+--------------+-----------+
| 101          | Confirmed | 
| 102          | Waitlist  | 
| 103          | Confirmed | 
| 104          | Confirmed | 
| 105          | Confirmed | 
| 106          | Waitlist  | 
| 107          | Confirmed | 
+--------------+-----------+
<b>è§£é‡Šï¼š</b>
- èˆªç­ 1 çš„å®¹é‡ä¸º 2 ä½ä¹˜å®¢ã€‚ä¹˜å®¢ 101 å’Œä¹˜å®¢ 103 æ˜¯æœ€å…ˆé¢„è®¢æœºç¥¨çš„ï¼Œå·²ç»ç¡®è®¤ä»–ä»¬çš„é¢„è®¢ã€‚ç„¶è€Œï¼Œä¹˜å®¢ 102 æ˜¯ç¬¬ä¸‰ä½é¢„è®¢è¯¥èˆªç­çš„ä¹˜å®¢ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰æ›´å¤šçš„å¯ç”¨åº§ä½ã€‚ä¹˜å®¢ 102 ç°åœ¨è¢«åˆ—å…¥ç­‰å€™åå•ã€‚
- èˆªç­ 2 çš„å®¹é‡ä¸º 2 ä½ä¹˜å®¢ï¼Œå·²ç»æœ‰ä¸¤ä½ä¹˜å®¢é¢„è®¢äº†æœºç¥¨ï¼Œä¹˜å®¢ 104 å’Œä¹˜å®¢ 105ã€‚ç”±äºé¢„è®¢æœºç¥¨çš„ä¹˜å®¢æ•°ä¸å¯ç”¨åº§ä½æ•°ç›¸ç¬¦ï¼Œè¿™ä¸¤ä¸ªé¢„è®¢éƒ½å¾—åˆ°äº†ç¡®è®¤ã€‚
- èˆªç­ 3 çš„å®¹é‡ä¸º 1 ä½ä¹˜å®¢ï¼Œä¹˜å®¢ 107 å…ˆé¢„è®¢å¹¶è·å¾—äº†å”¯ä¸€çš„å¯ç”¨åº§ä½ï¼Œç¡®è®¤äº†ä»–ä»¬çš„é¢„è®¢ã€‚é¢„è®¢æ—¶é—´åœ¨ä¹˜å®¢ 107 ä¹‹åçš„ä¹˜å®¢ 106 è¢«åˆ—å…¥ç­‰å€™åå•ã€‚</pre>

<!-- description:end -->

## è§£æ³•

<!-- solution:start -->

### æ–¹æ³•ä¸€ï¼šRank() çª—å£å‡½æ•°

æ³¨æ„ï¼Œå¦‚æœå¤šä¸ªäººåœ¨åŒä¸€æ—¶é—´é¢„å®šäº†åŒä¸€ä¸ªèˆªç­ï¼Œåªè¦æœ‰ç©ºä½ï¼Œå°±éƒ½å¯ä»¥ç¡®è®¤é¢„å®šã€‚

<!-- tabs:start -->

#### MySQL

```sql
# Write your MySQL query statement below
SELECT
    passenger_id,
    IF(
        (
            RANK() OVER (
                PARTITION BY flight_id
                ORDER BY booking_time
            )
        ) <= capacity,
        'Confirmed',
        'Waitlist'
    ) AS Status
FROM
    Passengers
    JOIN Flights USING (flight_id)
ORDER BY passenger_id;
```

<!-- tabs:end -->

<!-- solution:end -->

<!-- problem:end -->
